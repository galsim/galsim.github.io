/*!
    photobox v1.9.9
    (c) 2013 Yair Even Or <http://dropthebit.com>

    MIT-style license.
*/

(function(c,k,M){function la(a,b){var n=!1;return function(){n||(a.call(),n=!0,setTimeout(function(){n=!1},b))}}function W(){X&&e.hide();c(k).on("touchstart.testMouse",function(){c(k).off("touchstart.testMouse");Q=!0;e.addClass("mobile")});t.off().on("click",r.toggle);p.off().on("click","a",B.click);y&&e.addClass("msie");e.off().on("click","img",function(a){a.stopPropagation()});c(k.body).append(e);C=k.documentElement}function ma(a,b,n){1==b?(f.css({transform:"translateX(25%)",transition:".2s",opacity:0}),
setTimeout(function(){G(D)},200)):-1==b&&(f.css({transform:"translateX(-25%)",transition:".2s",opacity:0}),setTimeout(function(){G(z)},200));1==n?N.prop("checked",!0):-1==n&&N.prop("checked",!1)}function Y(a){var b,n=k.createElement("p").style,c=["ms","O","Moz","Webkit"];if(""==n[a])return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(b=c.length;b--;)if(""==n[c[b]+a])return c[b]+a}function na(a){a=a.keyCode;var b=d.keys;return 0<=c.inArray(a,b.close)&&I()||0<=c.inArray(a,b.next)&&!d.single&&J(z)||
0<=c.inArray(a,b.prev)&&!d.single&&J(D)||!0}function oa(a,b,n){1==n?J(z):-1==n&&J(D)}function Z(){J("pbPrevBtn"==this.id?D:z);return!1}function pa(a){aa=w;w=a;E=g[a][0];D=(w||(d.loop?g.length:0))-1;z=(w+1)%g.length||(d.loop?0:-1)}function J(a){if(!d.loop){var b=0==w&&a==D;if(w==g.length-1&&a==z||b)return}G(a)}function qa(){var a=g[w][0],b=c("<a>").prop("href",g[w][0])[0].search?"&":"?",a=a+(b+"vq=hd720&wmode=opaque");return c("<iframe>").prop({scrolling:"no",frameborder:0,allowTransparency:!0,src:a}).attr({webkitAllowFullScreen:!0,
mozallowfullscreen:!0,allowFullScreen:!0})}function R(){S.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd").removeClass("change");if(d.counter){try{var a=d.counter.replace("A",w+1).replace("B",g.length)}catch(b){d.counter="(A/B)",R()}K.find(".counter").text(a)}d.title&&K.find(".title").html("<span>"+g[w][1]+"</span>")}function ra(){e.addClass("error");f[0].src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";A.onerror=null}function ba(a){function b(){clearTimeout(c);
n.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd").css({transition:"none"});e.removeClass("video");"video"==L?(f[0].src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",v.addClass("prepare"),e.addClass("video")):f.prop({src:E,"class":"prepare"});setTimeout(function(){f.add(v).removeAttr("style").removeClass("prepare");e.removeClass("hide next prev");setTimeout(function(){f.add(v).on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",
ca);y&&ca()},0)},50)}var n,c;c=setTimeout(b,2E3);T.fadeOut(300,function(){e.removeClass("pbLoading");T.removeAttr("style")});e.addClass("hide");f.add(v).removeAttr("style").removeClass("zoomable");a||"video"!=H[aa].rel?n=f:(n=v,f.addClass("prepare"));if(a||y)b();else n.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",b)}function ca(){f.add(v).off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd").addClass("zoomable");"video"==L?v.removeClass("hide"):t&&d.autoplay&&
r.play();"function"==typeof x.callback&&x.callback.apply(H[w])}function sa(a,b,n){if(n)return!1;if("video"==L){var d=v.data("zoom")||1,d=d+b/10;if(.5>d)return!1;v.data("zoom",d).css({width:624*d,height:351*d})}else if(d=f.data("zoom")||1,a=f[0].getBoundingClientRect(),d+=b/10,.1>d&&(d=.1),U(function(){f.data("zoom",d).css({transform:"scale("+d+")"})}),a.height>C.clientHeight||a.width>C.clientWidth)c(k).on("mousemove.photobox",ta);else c(k).off("mousemove.photobox"),f[0].style[da]="50% 50%";return!1}
function ua(a,b){a.preventDefault();a.stopPropagation();var c=x.thumbsList;c.css("height",c[0].clientHeight+10*b);c=K[0].clientHeight/2;V[0].style.cssText="margin-top: -"+c+"px; padding: "+c+"px 0;";p.hide().show(0)}function ta(a){var b=(a.clientY/C.clientHeight*(C.clientHeight+200)-100)/C.clientHeight*100,c=(a.clientX/C.clientWidth*100).toFixed(2)+"% "+b.toFixed(2)+"%";U(function(){f[0].style[da]=c})}function ea(){clearTimeout(r.autoPlayTimer);c(k).off("mousemove.photobox");A.onload=function(){};
A.src=fa.src=ga.src=E}function I(){function a(){""!=e[0].className&&(e.removeClass("show hide error pbLoading"),f.removeAttr("class").removeAttr("style").off().data("zoom",1),K.find(".title").empty(),X&&setTimeout(function(){e.hide()},200),d.hideFlash&&c("iframe, object, embed").css("visibility","visible"))}if(!e.hasClass("show"))return!1;ea();v.find("iframe").prop("src","").empty();O.prototype.setup();P.clear();e.removeClass("on video").addClass("hide");f.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",
a);y&&a();setTimeout(function(){x=null},1E3);setTimeout(a,500);"function"===typeof d.afterClose&&d.afterClose(e)}var O,x,d,g=[],H,w=-1,E,aa,L,D,z,B,C,r,G,y=!("placeholder"in k.createElement("input")),X=function(){var a=c("<p>")[0];a.style.cssText="pointer-events:auto";return!a.style.pointerEvents}(),Q=!1,F=c(),da=Y("transformOrigin"),va=Y("transition"),U=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,
1E3/60)},A={},fa=new Image,ga=new Image,f,v,ha,ia,N,K,S,T,t,p,V,ja={single:!1,beforeShow:null,afterClose:null,loop:!0,thumb:null,thumbs:!0,thumbAttr:"data-src",counter:"(A/B)",title:!0,autoplay:!1,time:3E3,history:!1,hideFlash:!0,zoomable:!0,wheelNextPrev:!0,keys:{close:[27,88,67],prev:[37,80],next:[39,78]}},e=c('<div id="pbOverlay">').append(N=c('<input type="checkbox" id="pbThumbsToggler" checked hidden>'),T=c('<div class="pbLoader"><b></b><b></b><b></b></div>'),ha=c('<div id="pbPrevBtn" class="prevNext"><b></b></div>').on("click",
Z),ia=c('<div id="pbNextBtn" class="prevNext"><b></b></div>').on("click",Z),V=c('<div class="pbWrapper">').append(f=c("<img>"),v=c("<div>")),c('<div id="pbCloseBtn">').on("click",I)[0],t=c('<div id="pbAutoplayBtn">').append(c('<div class="pbProgress">')),K=c('<div id="pbCaption">').append('<label for="pbThumbsToggler" title="thumbnails on/off"></label>',S=c('<div class="pbCaptionText">').append('<div class="title"></div><div class="counter">'),p=c("<div>").addClass("pbThumbs")));c.fn.photobox=function(a,
b,d){return this.each(function(){var e;if(e=c(this).data("_photobox"))return"destroy"===a&&e.destroy(),this;"string"!=typeof a&&(a="a");if("prepareDOM"===a)return W(),this;e=c.extend({},ja,b||{});x=new O(e,this,a);c(this).data("_photobox",x);x.callback=d})};O=function(a,b,d){this.options=c.extend({},a);this.target=d;this.selector=c(b||k);this.thumbsList=null;a=this.imageLinksFilter(this.selector.find(d));this.imageLinks=a[0];this.images=a[1];this.init()};O.prototype={init:function(){var a=this;this.selector.one("mouseenter.photobox",
this.target,function(b){a.thumbsList=B.generate.apply(a)});this.selector.on("click.photobox",this.target,function(b){b.preventDefault();a.open(this)});this.observerTimeout=null;1==this.selector[0].nodeType&&this.observeDOM(this.selector[0],this.onDOMchanges.bind(this))},onDOMchanges:function(){var a=this;clearTimeout(this.observerTimeout);a.observerTimeout=setTimeout(function(){var b=a.imageLinksFilter(a.selector.find(a.target)),c=0;if(a.imageLinks.length!=b[0].length){a.imageLinks=b[0];a.images=
b[1];if(x&&a.selector==x.selector)for(g=a.images,H=a.imageLinks,b=g.length;b--;);a.thumbsList=B.generate.apply(a);p.html(a.thumbsList);a.images.length&&E&&a.options.thumbs&&(c=a.thumbsList.find('a[href="'+E+'"]').eq(0).parent().index(),-1==c&&(c=0),B.changeActive(c,0))}},50)},open:function(a){var b=c.inArray(a,this.imageLinks);if(-1==b)return!1;d=this.options;g=this.images;H=this.imageLinks;x=this;this.setup(1);e.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){e.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd").addClass("on");
G(b,!0)}).addClass("show");y&&e.trigger("MSTransitionEnd");return!1},imageLinksFilter:function(a){var b=this,d=[],e,q,f,m;return[a.filter(function(a){a=c(this);var h,ka="";e=a[0].getAttribute("title")||"";b.options.thumb&&(h=a.find(b.options.thumb)[0]);b.options.thumb&&h||(h=a.find("img")[0]);h&&(m=h.getAttribute("data-pb-captionlink"),ka=h.getAttribute(b.options.thumbAttr)||h.getAttribute("src"),e=h.getAttribute("alt")||h.getAttribute("title")||"");m&&(m=m.split("["),2==m.length?(q=m[0],f=m[1].slice(0,
-1)):f=q=m,e+=' <a href="'+f+'">'+q+"</a>");d.push([a[0].href,e,ka]);return!0}),d]},observeDOM:function(){var a=M.MutationObserver||M.WebKitMutationObserver,b=M.addEventListener;return function(c,d){if(a){var e=this;(new a(function(a,b){(a[0].addedNodes.length||a[0].removedNodes.length)&&d(e)})).observe(c,{childList:!0,subtree:!0})}else b&&(c.addEventListener("DOMNodeInserted",d.bind(e),!1),c.addEventListener("DOMNodeRemoved",d.bind(e),!1))}}(),setup:function(a){var b=a?"on":"off";f[0].src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";
if(d.thumbs&&!Q)p[b]("mouseenter.photobox",B.calc)[b]("mousemove.photobox",B.move);a?(f.css({transition:"0s"}).removeAttr("style"),e.show(),p.html(this.thumbsList).trigger("mouseenter.photobox"),d.thumbs?e.addClass("thumbs"):(N.prop("checked",!1),e.removeClass("thumbs")),2>this.images.length||d.single?e.removeClass("thumbs hasArrows hasCounter hasAutoplay"):(e.addClass("hasArrows hasCounter"),1E3<d.time?(e.addClass("hasAutoplay"),d.autoplay?r.progress.start():r.pause()):e.removeClass("hasAutoplay")),
d.hideFlash&&c("iframe, object, embed").css("visibility","hidden")):c(M).off("resize.photobox");c(k).off("keydown.photobox")[b]({"keydown.photobox":na});Q&&(e.removeClass("hasArrows"),V[b]("swipe",ma));if(d.zoomable&&(e[b]({"mousewheel.photobox":sa}),!y))p[b]({"mousewheel.photobox":ua});if(!d.single&&d.wheelNextPrev)e[b]({"mousewheel.photobox":la(oa,1E3)})},destroy:function(){d=this.options;this.selector.off("click.photobox",this.target).removeData("_photobox");I()}};B=function(){var a=0,b=0,e=0,
f=0,q=null,g,m,k,h;return{generate:function(){var a=c("<ul>"),b=[],d=this.imageLinks.size(),e,n,f,l,q;for(q=0;q<d;q++)if(f=this.imageLinks[q],n=this.images[q][2])e=this.images[q][1],l=f.rel?" class='"+f.rel+"'":"",b.push("<li"+l+'><a href="'+f.href+'"><img src="'+n+'" alt="" title="'+e+'" /></a></li>');a.html(b.join(""));return a},click:function(a){a.preventDefault();F.removeClass("active");F=c(this).parent().addClass("active");a=c(this.parentNode).index();return G(a,0,1)},changeActiveTimeout:null,
changeActive:function(a,b,c){d.thumbs&&(F.index(),F.removeClass("active"),F=p.find("li").eq(a).addClass("active"),!c&&F[0]&&(clearTimeout(this.changeActiveTimeout),this.changeActiveTimeout=setTimeout(function(){var a=F[0].offsetLeft+F[0].clientWidth/2-C.clientWidth/2;b?p.delay(800):p.stop();p.animate({scrollLeft:a},500,"swing")},200)))},calc:function(c){m=p[0];a=m.clientWidth;b=m.scrollWidth;g=.15*a;e=p.offset().left;f=c.pageX-g-e;h=f/(a-2*g);k=(b-a)*h;p.animate({scrollLeft:k},200);clearTimeout(q);
q=setTimeout(function(){q=null},200);return this},move:function(c){if(!q){c=c.pageX-g-e;var d;0>c&&(c=0);d=c/(a-2*g)*(b-a);U(function(){m.scrollLeft=d})}}}}();r={autoPlayTimer:!1,play:function(){r.autoPlayTimer=setTimeout(function(){G(z)},d.time);r.progress.start();t.removeClass("play");r.setTitle("Click to stop autoplay");d.autoplay=!0},pause:function(){clearTimeout(r.autoPlayTimer);r.progress.reset();t.addClass("play");r.setTitle("Click to resume autoplay");d.autoplay=!1},progress:{reset:function(){t.find("div").removeAttr("style");
setTimeout(function(){t.removeClass("playing")},200)},start:function(){y||t.find("div").css(va,d.time+"ms");t.addClass("playing")}},setTitle:function(a){a&&t.prop("title",a+" (every "+d.time/1E3+" seconds)")},toggle:function(a){a.stopPropagation();r[d.autoplay?"pause":"play"]()}};G=function(){var a;return function(b,c,k){if(!a){a=setTimeout(function(){a=null},150);if(!b||0>b)b=0;d.loop||(ia[b==g.length-1?"addClass":"removeClass"]("hide"),ha[0==b?"addClass":"removeClass"]("hide"));"function"==typeof d.beforeShow&&
d.beforeShow(H[b]);e.removeClass("error").addClass(b>w?"next":"prev");pa(b);ea();v.empty();A.onerror=null;f.add(v).data("zoom",1);L="video"==H[b].rel?"video":"image";if("video"==L)v.html(qa()).addClass("hide"),ba(c);else{var q=setTimeout(function(){e.addClass("pbLoading")},50);y&&e.addClass("hide");d.autoplay&&r.progress.reset();A=new Image;A.onload=function(){A.onload=null;0<=D&&(fa.src=g[D][0]);0<=z&&(ga.src=g[z][0]);clearTimeout(q);ba(c)};A.onerror=ra;A.src=E}S.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",
R).addClass("change");(c||y)&&R();B.changeActive(b,c,k);P.save()}}}();var P={save:function(){"pushState"in window.history&&decodeURIComponent(window.location.hash.slice(1))!=E&&d.history&&window.history.pushState("photobox",k.title+"-"+g[w][1],window.location.pathname+window.location.search+"#"+encodeURIComponent(E))},load:function(){if(d&&!d.history)return!1;var a=decodeURIComponent(window.location.hash.slice(1));!a&&e.hasClass("show")&&I();c('a[href="'+a+'"]').trigger("click.photobox")},clear:function(){d.history&&
"pushState"in window.history&&window.history.pushState("photobox",k.title,window.location.pathname+window.location.search)}};window.onpopstate=function(){var a=window.onpopstate;return function(c){a&&a.apply(this,arguments);"photobox"==c.state&&P.load()}}();c.event.special.swipe={setup:function(){c(this).bind("touchstart",c.event.special.swipe.handler)},teardown:function(){c(this).unbind("touchstart",c.event.special.swipe.handler)},handler:function(a){function b(){r.removeEventListener("touchmove",
d);g=m=null}function d(f){f.preventDefault();var q=g-f.touches[0].pageX;f=m-f.touches[0].pageY;20<=Math.abs(q)?(b(),k=0<q?-1:1):20<=Math.abs(f)&&(b(),h=0<f?1:-1);a.type="swipe";e.unshift(a,k,h);return(c.event.dispatch||c.event.handle).apply(r,e)}var e=[].slice.call(arguments,1),f=a.originalEvent.touches,g,m,k=0,h=0,r=this;a=c.event.fix(a);1==f.length&&(g=f[0].pageX,m=f[0].pageY,this.addEventListener("touchmove",d,!1))}};!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==
typeof exports?module.exports=a:a(jQuery)}(function(a){function c(b){var g=b||window.event,k=r.call(arguments,1),h=0,u=0,l=0,m=0,v=0,w=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(l=-1*g.detail),"wheelDelta"in g&&(l=g.wheelDelta),"wheelDeltaY"in g&&(l=g.wheelDeltaY),"wheelDeltaX"in g&&(u=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(u=-1*l,l=0),h=0===l?u:l,"deltaY"in g&&(l=-1*g.deltaY,h=l),"deltaX"in g&&(u=g.deltaX,0===l&&(h=-1*u)),0!==l||0!==u){if(1===g.deltaMode)var t=a.data(this,
"mousewheel-line-height"),h=h*t,l=l*t,u=u*t;else 2===g.deltaMode&&(t=a.data(this,"mousewheel-page-height"),h*=t,l*=t,u*=t);if(m=Math.max(Math.abs(l),Math.abs(u)),(!f||f>m)&&(f=m,p.settings.adjustOldDeltas&&"mousewheel"===g.type&&0===m%120&&(f/=40)),p.settings.adjustOldDeltas&&"mousewheel"===g.type&&0===m%120&&(h/=40,u/=40,l/=40),h=Math[1<=h?"floor":"ceil"](h/f),u=Math[1<=u?"floor":"ceil"](u/f),l=Math[1<=l?"floor":"ceil"](l/f),p.settings.normalizeOffset&&this.getBoundingClientRect)g=this.getBoundingClientRect(),
v=b.clientX-g.left,w=b.clientY-g.top;return b.deltaX=u,b.deltaY=l,b.deltaFactor=f,b.offsetX=v,b.offsetY=w,b.deltaMode=0,k.unshift(b,h,u,l),e&&clearTimeout(e),e=setTimeout(d,200),(a.event.dispatch||a.event.handle).apply(this,k)}}function d(){f=null}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],k="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],r=Array.prototype.slice;if(a.event.fixHooks)for(var h=g.length;h;)a.event.fixHooks[g[--h]]=
a.event.mouseHooks;var p=a.event.special.mousewheel={version:"3.1.11",setup:function(){if(this.addEventListener)for(var d=k.length;d;)this.addEventListener(k[--d],c,!1);else this.onmousewheel=c;a.data(this,"mousewheel-line-height",p.getLineHeight(this));a.data(this,"mousewheel-page-height",p.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var d=k.length;d;)this.removeEventListener(k[--d],c,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height");a.removeData(this,
"mousewheel-page-height")},getLineHeight:function(b){b=a(b)["offsetParent"in a.fn?"offsetParent":"parent"]();return b.length||(b=a("body")),parseInt(b.css("fontSize"),10)},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});c(k).ready(W);window._photobox={DOM:{overlay:e},close:I,history:P,defaults:ja}})(jQuery,
document,window);